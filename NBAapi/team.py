import requests
import pandas as pd
from NBAapi.credentials import DEFAULT_HEADERS

def stats(conference='',datefrom='',dateto='',div='',gamescope='',gamesegment='',lastngames=0,
          leagueid='00',location='',measuretype='Base',month=0,oppenentteamid=0,outcome='',
          poround=0,paceadjust='N',permode='PerGame',period=0,playerexperience='',
          playerposition='',plusminus='N',rank='N',
          season='2015-16',seasonsegment='',seasontype='Regular Season',shotclockrange='',
          starterbench='',teamid=0,vsconference='',vsdivision=''):
    url = 'http://stats.nba.com/stats/leaguedashteamstats?'
    api_param = {
        'Conference' :conference,
        'DateFrom' :  datefrom,
        'DateTo' : dateto,
        'Division' : div,
        'GameScope' : gamescope,
        'GameSegment' : gamesegment,
        'LastNGames' : lastngames,
        'LeagueID' : leagueid,
        'Location' : location,
        'MeasureType' : measuretype,
        'Month' : month,
        'OpponentTeamID' : oppenentteamid,
        'Outcome' : outcome,
        'PORound' : poround,
        'PaceAdjust' : paceadjust,
        'PerMode' : permode,
        'Period' : period,
        'PlayerExperience' : playerexperience,
        'PlayerPosition' : playerposition,
        'PlusMinus' : plusminus,
        'Rank' : rank,
        'Season' : season,
        'SeasonSegment' : seasonsegment,
        'SeasonType' : seasontype,
        'ShotClockRange' : shotclockrange,
        'StarterBench' : starterbench,
        'TeamID' : teamid,
        'VsConference': vsconference,
        'VsDivision' : vsdivision              
    }
    u_a = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.82 Safari/537.36"
    response = requests.get(url,params=api_param,headers=DEFAULT_HEADERS)
    data = response.json()
    return pd.DataFrame(data['resultSets'][0]['rowSet'],columns=data['resultSets'][0]['headers'])
    
def gamelog(teamid,seasontype='Regular Season',leagueid='00',season='2016-17'):
    url = 'http://stats.nba.com/stats/teamgamelog?'
    api_param = {
        'SeasonType' : seasontype,
        'LeagueID' : leagueid,
        'Season' : season,
        'teamID' : teamid,              
    }
    u_a = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.82 Safari/537.36"
    response = requests.get(url,params=api_param,headers=DEFAULT_HEADERS)
    data = response.json()
    return pd.DataFrame(data['resultSets'][0]['rowSet'],columns=data['resultSets'][0]['headers'])
    

def commonteamyears(leagueid='00'):   
    url = 'http://stats.nba.com/stats/commonteamyears?'
    api_param = {
        'LeagueID' : leagueid,            
    }
    u_a = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.82 Safari/537.36"
    response = requests.get(url,params=api_param,headers=DEFAULT_HEADERS)
    data = response.json()
    return pd.DataFrame(data['resultSets'][0]['rowSet'],columns=data['resultSets'][0]['headers'])

def roster(teamid,season='2016-17',leagueid='00'):
    url = 'http://stats.nba.com/stats/commonteamroster?'
    api_param = {
        'LeagueID' : leagueid,
        'Season' : season,
        'teamID' : teamid,              
    }
    u_a = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.82 Safari/537.36"
    response = requests.get(url,params=api_param,headers=DEFAULT_HEADERS)
    data = response.json()
    return pd.DataFrame(data['resultSets'][0]['rowSet'],columns=data['resultSets'][0]['headers'])    

def team_list():
    teams = pd.DataFrame({'ABBREVIATION': {0: 'ATL',
                          1: 'BOS',
                          2: 'CHA',
                          3: 'CHI',
                          4: 'CLE',
                          5: 'DAL',
                          6: 'DEN',
                          7: 'DET',
                          8: 'GSW',
                          9: 'HOU',
                          10: 'IND',
                          11: 'LAC',
                          12: 'LAL',
                          13: 'MIA',
                          14: 'MIL',
                          15: 'MIN',
                          16: 'NJN',
                          17: 'NYK',
                          18: 'ORL',
                          19: 'PHI',
                          20: 'PHX',
                          21: 'POR',
                          22: 'SAC',
                          23: 'SAS',
                          24: 'SEA',
                          25: 'TOR',
                          26: 'UTA',
                          27: 'VAN',
                          28: 'WAS',
                          29: 'MEM',
                          30: 'NOH',
                          31: 'CHA',
                          32: 'OKC',
                          33: 'BKN',
                          34: 'NOP',
                          35: 'LAC'},
                         'TEAM_ID': {0: 1610612737,
                          1: 1610612738,
                          2: 1610612766,
                          3: 1610612741,
                          4: 1610612739,
                          5: 1610612742,
                          6: 1610612743,
                          7: 1610612765,
                          8: 1610612744,
                          9: 1610612745,
                          10: 1610612754,
                          11: 1610612746,
                          12: 1610612747,
                          13: 1610612748,
                          14: 1610612749,
                          15: 1610612750,
                          16: 1610612751,
                          17: 1610612752,
                          18: 1610612753,
                          19: 1610612755,
                          20: 1610612756,
                          21: 1610612757,
                          22: 1610612758,
                          23: 1610612759,
                          24: 1610612760,
                          25: 1610612761,
                          26: 1610612762,
                          27: 1610612763,
                          28: 1610612764,
                          29: 1610612763,
                          30: 1610612740,
                          31: 1610612766,
                          32: 1610612760,
                          33: 1610612751,
                          34: 1610612740,
                          35: 1610612746},
                         'TEAM_NAME': {0: 'Atlanta Hawks',
                          1: 'Boston Celtics',
                          2: 'Charlotte Hornets',
                          3: 'Chicago Bulls',
                          4: 'Cleveland Cavaliers',
                          5: 'Dallas Mavericks',
                          6: 'Denver Nuggets',
                          7: 'Detroit Pistons',
                          8: 'Golden State Warriors',
                          9: 'Houston Rockets',
                          10: 'Indiana Pacers',
                          11: 'Los Angeles Clippers',
                          12: 'Los Angeles Lakers',
                          13: 'Miami Heat',
                          14: 'Milwaukee Bucks',
                          15: 'Minnesota Timberwolves',
                          16: 'New Jersey Nets',
                          17: 'New York Knicks',
                          18: 'Orlando Magic',
                          19: 'Philadelphia 76ers',
                          20: 'Phoenix Suns',
                          21: 'Portland Trail Blazers',
                          22: 'Sacramento Kings',
                          23: 'San Antonio Spurs',
                          24: 'Seattle SuperSonics',
                          25: 'Toronto Raptors',
                          26: 'Utah Jazz',
                          27: 'Vancouver Grizzlies',
                          28: 'Washington Wizards',
                          29: 'Memphis Grizzlies',
                          30: 'New Orleans Hornets',
                          31: 'Charlotte Bobcats',
                          32: 'Oklahoma City Thunder',
                          33: 'Brooklyn Nets',
                          34: 'New Orleans Pelicans',
                          35: 'LA Clippers'},
                         'color': {0: (0.8862745098039215, 0.21568627450980393, 0.24313725490196078),
                          1: (0.0, 0.4470588235294118, 0.2235294117647059),
                          2: (0.0, 0.5176470588235295, 0.5568627450980392),
                          3: (0.7764705882352941, 0.0, 0.2),
                          4: (0.5254901960784314, 0.0, 0.2196078431372549),
                          5: (0.0, 0.38823529411764707, 0.6862745098039216),
                          6: (1.0, 0.7803921568627451, 0.17254901960784313),
                          7: (0.0, 0.23921568627450981, 0.6470588235294118),
                          8: (0.0, 0.40784313725490196, 0.7019607843137254),
                          9: (0.7764705882352941, 0.0, 0.2),
                          10: (1.0, 0.7215686274509804, 0.10980392156862745),
                          11: (0.0, 0.3333333333333333, 0.6039215686274509),
                          12: (0.996078431372549, 0.6627450980392157, 0.15294117647058825),
                          13: (0.596078431372549, 0.0, 0.1803921568627451),
                          14: (0.17254901960784313, 0.3215686274509804, 0.20392156862745098),
                          15: (0.0, 0.24705882352941178, 0.4392156862745098),
                          16: (0.0,0.0,0.0),
                          17: (0.9529411764705882, 0.3411764705882353, 0.12156862745098039),
                          18: (0.0, 0.4196078431372549, 0.7176470588235294),
                          19: (0.0, 0.4, 0.7137254901960784),
                          20: (0.8941176470588236, 0.37254901960784315, 0.12156862745098039),
                          21: (0.8705882352941177, 0.12549019607843137, 0.19607843137254902),
                          22: (0.32941176470588235, 0.1803921568627451, 0.5686274509803921),
                          23: (0.7137254901960784, 0.7490196078431373, 0.7490196078431373),
                          24: (0.0,0.0,0.0),
                          25: (0.7764705882352941, 0.0, 0.2),
                          26: (0.0, 0.16470588235294117, 0.3607843137254902),
                          27: (0.0,0.0,0.0),
                          28: (0.0, 0.16470588235294117, 0.3568627450980392),
                          29: (0.09411764705882353, 0.16470588235294117, 0.2823529411764706),
                          30: (0.0,0.0,0.0),
                          31: (0.0, 0.5176470588235295, 0.5568627450980392),
                          32: (0.0, 0.49019607843137253, 0.7647058823529411),
                          33: (0.0, 0.0, 0.0),
                          34: (0.0, 0.16862745098039217, 0.3607843137254902),
                          35: (0.0, 0.3333333333333333, 0.6039215686274509)},
                          'conference': {0: 'Eastern',
                          1: 'Eastern',
                          2: 'Eastern',
                          3: 'Eastern',
                          4: 'Eastern',
                          5: 'Western',
                          6: 'Western',
                          7: 'Eastern',
                          8: 'Western',
                          9: 'Western',
                          10: 'Eastern',
                          11: 'Western',
                          12: 'Western',
                          13: 'Eastern',
                          14: 'Eastern',
                          15: 'Western',
                          16: 'Eastern',
                          17: 'Eastern',
                          18: 'Eastern',
                          19: 'Eastern',
                          20: 'Western',
                          21: 'Western',
                          22: 'Western',
                          23: 'Western',
                          24: 'Western',
                          25: 'Eastern',
                          26: 'Western',
                          27: 'Western',
                          28: 'Eastern',
                          29: 'Western',
                          30: 'Western',
                          31: 'Eastern',
                          32: 'Western',
                          33: 'Eastern',
                          34: 'Western',
                          35: 'Western'}})
    return teams
    
    

    